import{d as k,u as C,e as a,o as x,c as L,b as f,f as r,b$ as u,c0 as g,c1 as w,w as l,a5 as c,g as j,k as m,i as N,c2 as V}from"./index-0a7a3a0a.js";import{_ as h}from"./SettingSelection.vue_vue_type_script_setup_true_lang-dd5d5594.js";import{d as $}from"./common-6ebb879e.js";import{u as T}from"./render-481fcf15.js";import{u as D}from"./site-cf9bf634.js";const E={key:0,px:"md:32 lg:64"},U={flex:"","flex-wrap":"",sm:"grid grid-cols-2","justify-between":"","gap-12":""},R={"mt-24":"",flex:"",sm:"justify-center","justify-between":"","gap-x-12":""},P=k({__name:"MainSetting",setup(B){const s=C(),_=T();function b(e){const o=u.children.find(t=>t.enName===e.enName).value.bgC;return m("div",{class:"flex items-center gap-x-8"},[m("div",{class:"w-16 h-16 circle border-1 border-fff",style:{backgroundColor:o}}),m("div",e.name)])}const d=D();function y(){const e={data:d.data,settings:s.settings},n=JSON.stringify(e),o=new Blob([n],{type:"application/json"}),t=URL.createObjectURL(o),i=document.createElement("a");i.download=`MoonStart_Data_${new Date().toLocaleString()}.json`,i.href=t,document.body.appendChild(i),i.click(),URL.revokeObjectURL(t),window.$notification.success({content:"已导出~",duration:3e3})}function S(){const e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",async()=>{var o;const n=(o=e.files)==null?void 0:o[0];if(n)try{const t=await n.text(),i=JSON.parse(t);if(!i.data||!i.settings)throw new Error("请导入合法的数据文件");p(i),window.$notification.success({content:"导入成功~",duration:3e3})}catch(t){window.$notification.error({content:t.message,duration:3e3})}}),e.click()}function v(){window.$dialog.warning({title:"提示",content:"数据重置后无法恢复，你确认要重置数据吗？",positiveText:"确认",negativeText:"取消",onPositiveClick(){p($(V)),window.$notification.success({content:"已重置~",duration:3e3}),d.setCateIndex(0),_.refreshSiteGroupList()}})}function p(e){d.setData(e.data),s.setSettings(e.settings),g(e.settings.theme)}return(e,n)=>{const o=N;return a(s).isSetting?(x(),L("section",E,[f("div",U,[r(h,{modelValue:a(s).settings.theme,"onUpdate:modelValue":n[0]||(n[0]=t=>a(s).settings.theme=t),title:a(u).name,options:a(u).children,"render-label":b,"label-field":"name","value-field":"enName","on-update-value":t=>("toggleTheme"in e?e.toggleTheme:a(g))(t)},null,8,["modelValue","title","options","on-update-value"]),r(h,{modelValue:a(s).settings.showLunar,"onUpdate:modelValue":n[1]||(n[1]=t=>a(s).settings.showLunar=t),title:a(w).name,options:a(w).children,"label-field":"name","value-field":"enName","on-update-value":t=>a(s).setSettings({showLunar:t})},null,8,["modelValue","title","options","on-update-value"])]),f("div",R,[r(o,{type:"primary",secondary:"",onClick:v},{default:l(()=>[c(" 重置数据 ")]),_:1}),r(o,{type:"primary",onClick:n[2]||(n[2]=t=>e.$router.back())},{default:l(()=>[c(" 完成 ")]),_:1}),r(o,{type:"success",secondary:"",onClick:S},{default:l(()=>[c(" 导入数据 ")]),_:1}),r(o,{type:"primary",onClick:y},{default:l(()=>[c(" 导出数据 ")]),_:1})])])):j("",!0)}}});export{P as _};
